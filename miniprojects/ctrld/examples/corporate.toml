# ctrld configuration file
# Generated by ctrld Configuration Manager
# Template: Corporate Network Configuration

[service]
    log_level = "debug"
    log_path = "/var/log/ctrld.log"
    cache_enable = true
    cache_size = 16384
    metrics_listener = "127.0.0.1:9090"
    metrics_query_stats = true

[network.0]
    name = "Admin Network"
    cidrs = ["10.1.0.0/24"]

[network.1]
    name = "Employee Network"
    cidrs = ["10.2.0.0/24"]

[network.2]
    name = "Guest Network"
    cidrs = ["10.3.0.0/24"]

[upstream.0]
    name = "Internal Corporate DNS"
    endpoint = "10.0.0.53"
    type = "legacy"
    timeout = 2000

[upstream.1]
    name = "Secure External DNS"
    endpoint = "https://security.cloudflare-dns.com/dns-query"
    type = "doh"
    timeout = 5000
    bootstrap_ip = "1.1.1.2"

[upstream.2]
    name = "Family Safe DNS"
    endpoint = "https://family.cloudflare-dns.com/dns-query"
    type = "doh"
    timeout = 5000
    bootstrap_ip = "1.1.1.3"

[listener.0]
    ip = "0.0.0.0"
    port = 53
    restricted = true

[listener.0.policy]
    name = "Corporate DNS Policy"
    networks = [
        {"network.0" = ["upstream.0", "upstream.1"]},
        {"network.1" = ["upstream.1"]},
        {"network.2" = ["upstream.2"]},
    ]
    rules = [
        {"*.corp.local" = ["upstream.0"]},
        {"*.internal" = ["upstream.0"]},
        {"malware.test" = []},
    ]